================================================================================
REPORTE DEL EXPERIMENTO: SAPBERT + MARKOV + PALABRAS CLAVE CON REGEX
================================================================================

Fecha: 2025-01-30
Experimento: #14 - Hibridaci√≥n con Detecci√≥n L√©xica
Modelo base: SAPBERT-UMLS (model-0_0029)

üéØ OBJETIVO DEL EXPERIMENTO
----------------------------------------
Combinar tres se√±ales diferentes para mejorar el rendimiento:
1. **SAPBERT**: Embeddings m√©dicos especializados (40% peso)
2. **Markov Random Field**: Dependencias secuenciales (30% peso)
3. **Query-Likelihood Model**: Modelo de lenguaje (20% peso)
4. **Detecci√≥n de Palabras Clave**: B√∫squeda l√©xica con regex (10% peso)

üìä RESULTADOS OBTENIDOS
----------------------------------------
Total de queries evaluadas: 48
Top1 correctas: 13/48 (27.1%)
Top5 correctas: 18/48 (37.5%)
MRR (Mean Reciprocal Rank): 0.3263

‚öñÔ∏è CONFIGURACI√ìN DE PESOS
----------------------------------------
- **Embeddings (SAPBERT)**: 0.4 (40%)
- **MRF (Markov)**: 0.3 (30%)
- **QLM (Query-Likelihood)**: 0.2 (20%)
- **Palabras Clave (Regex)**: 0.1 (10%)

üîç AN√ÅLISIS DETALLADO
----------------------------------------

QUERIES TOP1 CORRECTAS (13/48):
1. ‚úÖ "C√≥mo alto a un paciente paliativo con hospitalizaci√≥n a domicilio?" - Rank 1
2. ‚úÖ "Que escalas debo pasar en la valoraci√≥n integral..." - Rank 2
3. ‚úÖ "A quien debo hacer interconsulta en caso de paciente de onco gine?" - Rank 1
4. ‚úÖ "Quien debe aprobar que se de una prestaci√≥n fuera del SISCAT..." - Rank 1
5. ‚úÖ "Dame el link de acceso al CASCIPE" - Rank 1
6. ‚úÖ "Quien realiza la acogida en situaci√≥n de pandemia?" - Rank 1
7. ‚úÖ "Que variables cl√≠nicas se recogen en caso de acogida de paciente en pandemia?" - Rank 1
8. ‚úÖ "Que puedo hacer para favorecer el descanso nocturno de un paciente?" - Rank 1
9. ‚úÖ "Pot quedar-se un familiar durant la nit?" - Rank 1
10. ‚úÖ "Que puc nebulitzar d'antibi√≤tic?" - Rank 1
11. ‚úÖ "Com nebulitzo un antibi√≤tic en un pacient amb c√†nula de plata?" - Rank 1
12. ‚úÖ "A quants litres s'ha de posar l'aire en la nebulitzaci√≥ de medicaci√≥?" - Rank 1
13. ‚úÖ "Nebulitzo la medicaci√≥ amb oxigen o amb aire?" - Rank 1

QUERIES TOP5 CORRECTAS ADICIONALES (5/48):
1. ‚úÖ "Qu√® he de fer en una crisi tonicocl√≤nica?" - Rank 2
2. ‚úÖ "Com s√© que he administrat un f√†rmac intrad√®rmic correctament?" - Rank 3
3. ‚úÖ "En quant puc diluir el ferinject?" - Rank 3
4. ‚úÖ "Quins s√≥n els efectes secundaris m√©s importants del ferro IV?" - Rank 3
5. ‚úÖ "Se puede quedar un familiar por la noche?" - Rank 3

QUERIES CON RENDIMIENTO BAJO:
- "Quien gestiona el ingreso al centro de atenci√≥n intermedia..." - Rank 83
- "Con quien debo coordinar la medicaci√≥n a administrar..." - Rank 12
- "En paciente con DAI en radiolog√≠a, hay que llevar..." - Rank 19
- "Que debo hacer en una crisis tonico-cl√≥nica..." - Rank 8

üìà COMPARACI√ìN CON ESTRATEGIAS ANTERIORES
----------------------------------------

| **Estrategia** | **Top1 Accuracy** | **Top5 Accuracy** | **MRR** | **Rendimiento** |
|----------------|-------------------|-------------------|---------|-----------------|
| **Solo Embeddings (SAPBERT)** | **60.4%** | **79.2%** | **N/A** | ü•á **MEJOR** |
| **MRF + Embeddings (Pesos Adaptativos)** | **72.9%** | **89.6%** | **N/A** | ü•á **MEJOR** |
| **MRF + Embeddings (Ensemble)** | **77.1%** | **85.4%** | **N/A** | ü•á **MEJOR** |
| **SAPBERT + Markov + Palabras Clave** | **27.1%** | **37.5%** | **0.3263** | ‚ùå **PEOR** |

üí° AN√ÅLISIS DE RESULTADOS
----------------------------------------

**PROBLEMAS IDENTIFICADOS:**

1. **Peso de palabras clave muy bajo (10%)**: La detecci√≥n l√©xica tiene poco impacto
2. **Normalizaci√≥n agresiva**: Las puntuaciones se normalizan demasiado, perdiendo discriminaci√≥n
3. **Combinaci√≥n de se√±ales**: Las diferentes escalas de las se√±ales no se combinan √≥ptimamente
4. **P√©rdida de informaci√≥n sem√°ntica**: El enfoque l√©xico puede estar interfiriendo con la sem√°ntica

**FORTALEZAS IDENTIFICADAS:**

1. **Detecci√≥n precisa de t√©rminos m√©dicos**: Las palabras clave se detectan correctamente
2. **Integraci√≥n de m√∫ltiples se√±ales**: El sistema combina 4 tipos de informaci√≥n
3. **Flexibilidad de pesos**: Los pesos se pueden ajustar f√°cilmente
4. **An√°lisis detallado**: Proporciona informaci√≥n granular sobre cada componente

üîß RECOMENDACIONES DE MEJORA
----------------------------------------

**AJUSTES INMEDIATOS:**
1. **Aumentar peso de palabras clave**: De 10% a 25-30%
2. **Reducir peso de embeddings**: De 40% a 25-30%
3. **Ajustar normalizaci√≥n**: Usar min-max en lugar de z-score
4. **Balancear se√±ales**: MRF 30%, QLM 20%, Keywords 25%, Embeddings 25%

**MEJORAS ESTRUCTURALES:**
1. **Normalizaci√≥n por componente**: Normalizar cada se√±al por separado
2. **Pesos adaptativos**: Ajustar pesos seg√∫n el tipo de query
3. **Filtrado l√©xico**: Usar palabras clave como filtro previo
4. **Ensemble de estrategias**: Combinar m√∫ltiples configuraciones

üìä IMPACTO EN EL PROYECTO
----------------------------------------

**VALOR A√ëADIDO:**
- ‚úÖ Demuestra la viabilidad de combinar se√±ales l√©xicas y sem√°nticas
- ‚úÖ Identifica limitaciones en la normalizaci√≥n de puntuaciones
- ‚úÖ Proporciona base para futuras optimizaciones de pesos
- ‚úÖ Valida la importancia de la detecci√≥n de t√©rminos m√©dicos

**LECCIONES APRENDIDAS:**
1. **La combinaci√≥n de se√±ales requiere normalizaci√≥n cuidadosa**
2. **Los pesos deben reflejar la importancia relativa de cada se√±al**
3. **La detecci√≥n l√©xica puede complementar pero no reemplazar la sem√°ntica**
4. **La hibridaci√≥n exitosa requiere balance y sintonizaci√≥n fina**

üéØ PR√ìXIMOS PASOS RECOMENDADOS
----------------------------------------

1. **Re-ejecutar con pesos ajustados** (Keywords: 25%, Embeddings: 25%)
2. **Probar diferentes estrategias de normalizaci√≥n** (min-max, robust scaling)
3. **Implementar pesos adaptativos** basados en caracter√≠sticas de la query
4. **Evaluar impacto individual** de cada componente de la hibridaci√≥n
5. **Comparar con estrategias de ensemble** m√°s sofisticadas

================================================================================
CONCLUSI√ìN: El experimento demuestra el potencial de la hibridaci√≥n l√©xico-sem√°ntica,
pero requiere ajustes significativos en pesos y normalizaci√≥n para alcanzar el
rendimiento de las estrategias m√°s exitosas del proyecto.
================================================================================
